ğŸ›°ï¸ Information Gathering â€” Subdomain, DNS, WHOIS
Pentesting uchun toâ€˜liq qoâ€˜llanma

Information Gathering â€” pentestning 1-bosqichidir. Bu bosqichning maqsadi: maqsad (target) haqida maksimal maâ€™lumot yigâ€˜ish, subdomainlar, DNS konfiguratsiyasi, WHOIS/RDAP maâ€™lumotlar, IP bloklar, xizmatlar (services) va boshqa oshkor boâ€˜lgan komponentlarni aniqlash.

Bu qoâ€˜llanma quyidagilarni qamrab oladi:

Passive Recon (trafik yubormasdan)

Active Recon (DNS queries + brute-force)

Subdomain Enumeration

DNS tahlili

WHOIS/RDAP

Himoya qilish (Defense)

Detection & Logging

Amaliy workflow + Skript

1ï¸âƒ£ Etik va huquqiy qoidalar

Pentest faqat ruxsat bilan.

âœ” Maqsad, ruxsat doirasi (scope), IP bloklar oldindan kelishiladi
âœ” Passive vositalar xavfsiz, Active vositalar (nmap, brute-force) ehtiyotkorlik bilan
âœ” Rate-limit, log monitoring, xizmatlarga ziyon yetkazmaslik

2ï¸âƒ£ Subdomain Enumeration (subdomenlarni aniqlash)

Subdomainlar â€” kompaniyaning infratuzilmasidagi yashirin xizmatlar:
dev.example.com, vpn.example.com, api.example.com, jenkins.example.com.

ğŸ”¹ Passive Enumeration

Trafik yubormasdan, jamoat manbalaridan maâ€™lumot yigâ€˜ish.

Asboblar

crt.sh â€” sertifikatlar orqali subdomain topish

Amass (passive)

Subfinder

SecurityTrails

VirusTotal

Shodan/Censys

Buyruqlar
subfinder -d example.com
amass enum -passive -d example.com

crt.sh orqali qidiruv
https://crt.sh/?q=%25.example.com

ğŸ”¹ Active Enumeration

Faol DNS soâ€˜rovlar yuborish.

Asboblar

Gobuster

FFUF

dnsrecon

dnsenum

massdns

Subdomain brute-force
gobuster dns -d example.com -w wordlist.txt

massdns (tezkor resolve)
massdns -r resolvers.txt -t A -o S -w resolved.txt subdomains.txt

ğŸ”¹ Zone Transfer (AXFR)

Eng katta konfiguratsiya xatosi.

dig @ns1.example.com example.com AXFR


Agar muvaffaqiyatli boâ€˜lsa â€” butun DNS zonasi sizga ochiladi.

3ï¸âƒ£ DNS Enumeration & Tahlil

DNS â€” domen ekotizimidagi asosiy konfiguratsiyalarni koâ€˜rsatadi.

DNS yozuv turlari
Yozuv	Maâ€™nosi
A	IPv4 manzil
AAAA	IPv6 manzil
MX	Email server
NS	Nameserverlar
TXT	SPF/DKIM/DMARC + boshqa maâ€™lumotlar
CNAME	Alias
SOA	Zone boshqaruvi
SRV	Xizmat yozuvlari
CAA	Sertifikat chiqarish siyosati
Asosiy buyruqlar (dig)
dig A example.com
dig ANY example.com
dig NS example.com
dig MX example.com
dig TXT example.com

Reverse DNS
dig -x 93.184.216.34

DNSSEC tekshirish
dig +dnssec example.com

4ï¸âƒ£ WHOIS & RDAP

Domain egasi va administrator haqida maâ€™lumot olish uchun.

WHOIS
whois example.com

RDAP (yangi avlod WHOIS)
curl https://rdap.verisign.com/com/v1/domain/example.com

WHOIS orqali nimalar olinadi?

Egasi (registrant)

Admin email

Registratsiya sanasi

Muddati tugash sanasi

Registrar

Nameserverlar

ASN (IP bloklarni topish uchun)

5ï¸âƒ£ Kompleks Information Gathering Workflow

Quyidagi jarayon pentestingda eng yaxshi amaliyot hisoblanadi:

1. Passive Recon
amass enum -passive -d example.com
subfinder -d example.com -o subfinder.txt
crt.sh orqali sertifikat tekshirish

2. Birlashtirish va tozalash
cat subfinder.txt amass.txt | sort -u > subdomains.txt

3. Resolving (massdns)
massdns -r resolvers.txt -t A -o S -w resolved.txt subdomains.txt

4. Faol qidiruv
gobuster dns -d example.com -w wordlist.txt

5. DNS tahlil
dig ANY example.com
dig AXFR example.com

6. WHOIS & RDAP
whois example.com
curl https://rdap...

6ï¸âƒ£ Amaliy Bash Skript (Passive + Active)
#!/bin/bash

DOMAIN="example.com"

echo "[+] Passive subdomain collection..."
subfinder -d $DOMAIN -silent -o subfinder.txt
amass enum -passive -d $DOMAIN -o amass.txt

echo "[+] Merging and deduping..."
cat subfinder.txt amass.txt | sort -u > subs.txt

echo "[+] Resolving with massdns..."
massdns -r resolvers.txt -t A -o S -w resolved.txt subs.txt

echo "[+] Extracting live hosts..."
grep " A " resolved.txt | awk '{print $1}' | sed 's/\.$//' > live.txt

echo "[+] HTTP check..."
httpx -silent -l live.txt -o http_alive.txt

echo "[+] Completed."

7ï¸âƒ£ Detection (Monitoring / SIEM)

Tashkilot nuqtai nazaridan:

DNS monitoring

Koâ€˜p sonli subdomain soâ€˜rovlar

Nomaâ€™lum resolverlardan kelgan queryâ€™lar

ANY soâ€˜rovlar sonining oshishi

Web server loglari

404/400 lar koâ€˜payishi â†’ subdomain bruteforce belgisi

Certificate Transparency monitoring

Yangi cert chiqsa alert

8ï¸âƒ£ Himoya Choralar (Defense)
Zaiflik	Himoya
AXFR ochiq	Zone transferni faqat ishonchli NS'ga ruxsat berish
Koâ€˜p subdomainlar	Wildcard oâ€˜rniga aniq subdomainlar
WHOIS oshkora	WHOIS privacy yoqish
DNS spoofing	DNSSEC yoqish
OSINT oqishi	GitHub security scanning, token monitoring
Brute-force	Rate-limit, WAF, Bot-protection
9ï¸âƒ£ Tekshiruv uchun Wordlistlar
Subdomain

dns-Jhaddix.txt

bitquark-subdomains-top100k.txt

DNS resolvers

public-resolvers.txt (massdns uchun)

ğŸ”Ÿ Yakuniy Savollar (FAQ)

Wildcard DNS koâ€˜p false-positive beradi â€” nima qilaman?
â†’ Wildcard domenlarni aniqlab filtr qiling, HTTP status tekshiring.

WHOIS yopiq â€” maâ€™lumot qayerdan olinadi?
â†’ RDAP, SHA256 certificate fingerprint, ASN lookup.

AXFR ruxsat yoâ€˜q â€” lekin tekshirish kerakmi?
â†’ Ha, lekin faqat ruxsat doirasida.